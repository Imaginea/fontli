<% content_for :custom_js do %>
var header = $('#pinned_header');
var headerTop = header.position().top;
var headerHeight = header.innerHeight() + 2; // 2px borders
var nextElem = header.next();
var nextElemMargin = parseInt(nextElem.css('margin-top'));
var didScroll = false;

$(window).scroll(function() {
  didScroll = true;
});

setInterval(function() {
  if ( didScroll ) {
    didScroll = false;
    var winScroll = $(window).scrollTop();

    if ( winScroll >= headerTop ) {
      header.addClass('fixed-top');
      nextElem.css('margin-top', headerHeight + nextElemMargin + 'px');
    } else {
      header.removeClass('fixed-top');
      nextElem.css('margin-top', nextElemMargin + 'px');
    }
  }
}, 10);
<% end %>
